# ECG Adaptive Noise Cancellation

This project implements a Normalized Least Mean Squares (NLMS) adaptive filter in Python to clean noisy ECG signals.

The goal was to remove 50Hz powerline interference and low-frequency respiratory drift (baseline wander) without damaging the QRS complex of the heart signal.

## How it Works

The pipeline consists of four main stages:

1.  **Data Generation:** Creates synthetic ECG data mixed with strong 50Hz noise and breathing drift.
2.  **Adaptive Filtering:** Uses an NLMS algorithm to estimate and subtract the noise in real-time.
3.  **Validation:**
    * **SNR Calculation:** Measures signal quality before and after filtering.
    * **Spectral Analysis:** Uses FFT to prove the 50Hz peak is removed.
4.  **Feature Extraction:** Detects R-peaks to calculate Heart Rate (BPM).

## Key Features

* **Normalized LMS (NLMS):** Uses a normalized step size and leakage factor (gamma) for better stability than standard LMS.
* **Real-time Simulation:** The filter processes data sample-by-sample, simulating a real medical device.
* **Automatic BPM Detection:** Threshold-based peak detector to count heartbeats from the cleaned signal.
* **Dual Domain Analysis:** visualizes results in both Time Domain (waveforms) and Frequency Domain (PSD).

## Results

Typical results from a 12-second simulation:

* **SNR Improvement:** ~16 dB gain (from -7.2 dB to +9.6 dB).
* **BPM Accuracy:** Restores heart rate detection from inaccurate (~30 BPM) to accurate (~72 BPM).
* **Convergence:** The filter stabilizes and tracks the drift within the first few seconds.

## Project Structure

```text
/ECG_Adaptive_Filter
|
├── src/
│   ├── lms_algorithm.py    # Main filter logic, SNR calc, and BPM detection
│   └── generate_signals.py # Synthetic data generator
├── results/
│   └── plots/              # Saved output images (Time domain & FFT)
└── requirements.txt

## Installation & Usage
1. Clone the repo: `git clone https://github.com/YOUR_USERNAME/adaptive-ecg-denoising-lms.git`
2. Install dependencies: `pip install numpy matplotlib`
4. Run command: source `dsp_env/bin/activate`
3. Run the simulation: `python src/lms_algorithm.py`
